<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ABBY.WORLD Cannes 2025</title>
  <link rel="icon" href="favicon.png" type="image/png">
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background-color: black;
      font-family: Arial, sans-serif;
    }
    canvas {
      display: block;
    }
    #header {
      position: fixed;
      top: 10px;
      left: 10px;
      z-index: 10;
      color: white;
      font-size: 10px;
      font-family: Arial, sans-serif;
    }
  </style>
</head>
<body>
  <div id="header">ABBY.WORLD CANNES 2025</div>

  <audio id="bgMusic" autoplay loop>
    <source src="https://raw.githubusercontent.com/ABBY-WORLD/FIATLUX/main/fiatlux.mp3" type="audio/mpeg">
  </audio>

  <canvas id="canvas"></canvas>

  <script>
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");

    let rotationSpeedX = 0.005;
    let rotationSpeedY = 0.005;
    let focalLength = 1936;
    let numPoints = 261;
    let sphereRadius = Math.min(window.innerWidth, window.innerHeight) * 0.4;
    let points = [];

    function generateFibonacciSphere(n) {
      let pts = [];
      const phi = Math.PI * (3 - Math.sqrt(5));
      const words = ["ABBY", "WORLD"];
      for (let i = 0; i < n; i++) {
        let y = 1 - (i / (n - 1)) * 2;
        let radius = Math.sqrt(1 - y * y);
        let theta = phi * i;
        let x = Math.cos(theta) * radius;
        let z = Math.sin(theta) * radius;
        let word = words[Math.floor(Math.random() * words.length)];
        pts.push({ x: x * sphereRadius, y: y * sphereRadius, z: z * sphereRadius, word });
      }
      return pts;
    }

    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      sphereRadius = Math.min(canvas.width, canvas.height) * 0.4;
      points = generateFibonacciSphere(numPoints);
    }

    window.addEventListener("resize", resizeCanvas);
    resizeCanvas();

    function rotateY(point, angle) {
      const cosA = Math.cos(angle), sinA = Math.sin(angle);
      return {
        x: cosA * point.x + sinA * point.z,
        y: point.y,
        z: -sinA * point.x + cosA * point.z,
        word: point.word
      };
    }

    function rotateX(point, angle) {
      const cosA = Math.cos(angle), sinA = Math.sin(angle);
      return {
        x: point.x,
        y: cosA * point.y - sinA * point.z,
        z: sinA * point.y + cosA * point.z,
        word: point.word
      };
    }

    let angleX = 0, angleY = 0;
    let mouseX = 0, mouseY = 0;

    document.addEventListener("mousemove", e => {
      mouseX = e.clientX / window.innerWidth;
      mouseY = e.clientY / window.innerHeight;
    });

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      rotationSpeedX = 0.001 + (mouseY - 0.5) * 0.02;
      rotationSpeedY = 0.001 + (mouseX - 0.5) * 0.02;

      if (Math.random() < 0.01) {
        numPoints = 240 + Math.floor(Math.random() * 50);
        points = generateFibonacciSphere(numPoints);
      }

      let transformedPoints = points.map(p => rotateX(rotateY(p, angleY), angleX));
      transformedPoints.sort((a, b) => b.z - a.z);

      transformedPoints.forEach(p => {
        let scale = focalLength / (focalLength + Math.abs(p.z));
        let x2D = canvas.width / 2 + p.x * scale;
        let y2D = canvas.height / 2 + p.y * scale;

        let depthFactor = (p.z + sphereRadius) / (2 * sphereRadius);
        let brightness = depthFactor * 255;

        ctx.globalAlpha = p.z < 0 ? 0.5 : 1.0;
        let fontSize = p.z > 0 ? (8 + 6 * scale) : (6 + 4 * scale);
        ctx.fillStyle = `rgb(${brightness},${brightness},${brightness})`;
        ctx.font = `${fontSize}px Arial`;
        ctx.textAlign = "center";
        ctx.textBaseline = "middle";
        ctx.fillText(p.word, x2D, y2D);
      });

      ctx.globalAlpha = 1.0;
      angleX += rotationSpeedX;
      angleY += rotationSpeedY;
      requestAnimationFrame(draw);
    }

    draw();
  </script>
</body>
</html>
